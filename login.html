<!DOCTYPE html>
<html lang="es">
    <head>
        <title>Log In-Escribano</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1,maximum-scale=1,minimum-scale=1">
        <link rel="stylesheet" href="estilos2.css">
        <link href="https://fonts.googleapis.com/css?family=Josefin+Sans|Montez|Pathway+Gothic+One" rel="stylesheet">
        <link rel="shortcut icon" type="image/x-icon" href="img/escribano.ico">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    </head>
    <body>
       <div class="contenedor">
           <header>
               <h1 class="title">Escribano</h1>
               <a href="formulario.html">Regístrate</a>
           </header>
           <div class="login">
               <article class="fondo">
                   <img src="img/escribano.jpg" alt="User">
                   <h3>Inicio de sesión</h3>
                   <form name="loginform" onSubmit="return validateForm();" action="index.html" method="post">
                        <label>User name</label>
                        
                        <input class="inp" type="text" placeholder="&#128394 Username" name="usr">
                        <input class="inp" type="password" placeholder="&#128273 Password" name="psw">

                        <a href=""class="he">He olvidado mi contraseña</a>
                        <input class="boton" type="submit" name="inicio" value="Iniciar sesión"/>

                   </form>
               </article>
           </div>
        </div>
       
       <script>
        const url = 'http://localhost:52336/api/users';
        const url2 = 'https://randomuser.me/api/?results=10';

        function getUsers(un,pw){
            fetch(url)
            .then((resp) => resp.json())
            .then(function(data) {
                console.log(data)
                if(data.some(item => item.LoginName === un)){
                    if(data.some(item => item.Password === pw)){
                        sessionStorage.setItem('status','loggedIn') 
                        location.href ='index.html';
                    }else{
                        alert("Contraseña incorrecta");
                    }
                }else
                {
                    alert("Usuario incorrecto");
                }
                return data;
            })
            .catch(function(error) {
                console.log(error);
            });   
        }       
        // ******************************************************************************** //
        function validateForm() {
            var un = document.loginform.usr.value;
            var pw = document.loginform.psw.value;
            getUsers(un,pw);
            return false;
        }

        // ******************************************************************************** //
        </script>
        
        
    </body>
</html>